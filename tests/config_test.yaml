suite: test stratos metrics config
templates:
  - config.yaml
tests:
  - it: should support legacy kubernetes.authEndpoint
    set:
      firehoseExporter.enabled: false
      kubernetes.authEndpoint: https://auth-endpoint.com
    asserts:
      - equal:
          path: data.nginx-metadata
          value: |
            [
              {
                "type": "k8s",
                "url": "https://auth-endpoint.com",
                "job": "k8s-metrics"
              }
            ]
    
        documentIndex: 1
  - it: should support new kubernetes.apiEndpoint
    set:
      firehoseExporter.enabled: false
      kubernetes.apiEndpoint: https://api-endpoint.com
    asserts:
      - equal:
          path: data.nginx-metadata
          value: |
            [
              {
                "type": "k8s",
                "url": "https://api-endpoint.com",
                "job": "k8s-metrics"
              }
            ]
    
        documentIndex: 1
